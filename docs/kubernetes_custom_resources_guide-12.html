<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kubernetes Custom Resources - Day 40</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 3rem 2rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><polygon points="50,10 80,40 50,70 20,40" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="2"/><circle cx="50" cy="50" r="30" fill="none" stroke="rgba(255,255,255,0.05)" stroke-width="1"/></svg>');
            opacity: 0.3;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.3rem;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .content {
            padding: 2rem;
        }

        .section {
            margin-bottom: 4rem;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            background: white;
        }

        .section-header {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 1.5rem 2rem;
            font-size: 1.5rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .section-content {
            padding: 2.5rem;
            background: #f8f9fa;
        }

        .highlight-box {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            padding: 2rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            font-weight: 500;
            text-align: center;
            font-size: 1.1rem;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }

        .info-box {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 2rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .warning-box {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            color: white;
            padding: 2rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            box-shadow: 0 4px 15px rgba(243, 156, 18, 0.3);
        }

        .success-box {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
            color: white;
            padding: 2rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
        }

        .architecture-diagram {
            background: white;
            border: 3px solid #3498db;
            border-radius: 15px;
            padding: 3rem;
            margin: 2rem 0;
            text-align: center;
        }

        .api-extension-visual {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }

        .native-resources {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
            color: white;
            padding: 2rem;
            border-radius: 12px;
            text-align: center;
        }

        .custom-resources {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            padding: 2rem;
            border-radius: 12px;
            text-align: center;
        }

        .three-components {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .component-card {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
            border-top: 4px solid #3498db;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .component-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.15);
        }

        .component-card.crd {
            border-top-color: #e74c3c;
        }

        .component-card.cr {
            border-top-color: #f39c12;
        }

        .component-card.controller {
            border-top-color: #27ae60;
        }

        .component-card h4 {
            color: #2c3e50;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .flow-diagram {
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 2rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 12px;
            margin: 2rem 0;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .flow-step {
            background: #3498db;
            color: white;
            padding: 1.5rem;
            border-radius: 50px;
            min-width: 120px;
            text-align: center;
            font-weight: 600;
            position: relative;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .flow-step:not(:last-child)::after {
            content: '‚Üí';
            position: absolute;
            right: -25px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.8rem;
            color: #2c3e50;
        }

        .actors-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }

        .actor-card {
            background: white;
            border: 2px solid #3498db;
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
        }

        .devops-actor {
            border-color: #e74c3c;
        }

        .user-actor {
            border-color: #27ae60;
        }

        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 2rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            box-shadow: 0 4px 15px rgba(44, 62, 80, 0.3);
        }

        pre {
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .yaml-block {
            background: #34495e;
            color: #ecf0f1;
            padding: 2rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            box-shadow: 0 4px 15px rgba(52, 73, 94, 0.3);
            border-left: 4px solid #e74c3c;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-radius: 12px;
            overflow: hidden;
        }

        .comparison-table th {
            background: #2c3e50;
            color: white;
            padding: 1.5rem;
            text-align: left;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 1.5rem;
            border-bottom: 1px solid #ecf0f1;
        }

        .comparison-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .complete-flow {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
        }

        .step-sequence {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin: 2rem 0;
        }

        .step {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .step-number {
            background: #3498db;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .cncf-landscape {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            color: white;
            padding: 3rem;
            border-radius: 12px;
            margin: 2rem 0;
        }

        .examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .example-card {
            background: rgba(255,255,255,0.1);
            padding: 1.5rem;
            border-radius: 8px;
        }

        .development-info {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            color: white;
            padding: 2rem;
            border-radius: 12px;
            margin: 2rem 0;
        }

        .tech-stack {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .tech-item {
            background: rgba(255,255,255,0.1);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }

        .istio-example {
            background: #e8f5e8;
            border: 2px solid #27ae60;
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
        }

        .responsibilities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .responsibility-card {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 2rem;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.3);
        }

        .validation-flow {
            background: white;
            border: 2px solid #f39c12;
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
        }

        @media (max-width: 768px) {
            .api-extension-visual, .actors-section {
                grid-template-columns: 1fr;
            }
            
            .flow-diagram {
                flex-direction: column;
            }
            
            .flow-step:not(:last-child)::after {
                content: '‚Üì';
                right: 50%;
                top: 100%;
                transform: translateX(50%);
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }

        .emoji {
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><span class="emoji">üîß</span> Kubernetes Custom Resources</h1>
            <p>Day 40 - Complete DevOps Course</p>
            <p>Extend Kubernetes API with Custom Capabilities</p>
        </div>

        <div class="content">
            <!-- Introduction -->
            <div class="section">
                <div class="section-header">
                    <span class="emoji">üéØ</span> High-Level Overview: Extending Kubernetes
                </div>
                <div class="section-content">
                    <div class="highlight-box">
                        <strong>Core Concept:</strong> Kubernetes allows you to <strong>extend its API</strong> and <strong>introduce new resources</strong> beyond the native ones!
                    </div>

                    <div class="api-extension-visual">
                        <div class="native-resources">
                            <h3><span class="emoji">üè†</span> Native Kubernetes Resources</h3>
                            <h4>Out-of-the-box:</h4>
                            <ul>
                                <li><strong>Deployment</strong> - Application management</li>
                                <li><strong>Service</strong> - Network access</li>
                                <li><strong>Pod</strong> - Container wrapper</li>
                                <li><strong>ConfigMap</strong> - Configuration data</li>
                                <li><strong>Secret</strong> - Sensitive data</li>
                                <li><strong>Ingress</strong> - HTTP routing</li>
                            </ul>
                            <p><strong>Managed by:</strong> Built-in controllers</p>
                        </div>
                        <div class="custom-resources">
                            <h3><span class="emoji">üöÄ</span> Custom Resources</h3>
                            <h4>Extended capabilities:</h4>
                            <ul>
                                <li><strong>VirtualService</strong> (Istio) - Service mesh</li>
                                <li><strong>Application</strong> (Argo CD) - GitOps</li>
                                <li><strong>Certificate</strong> (cert-manager) - TLS management</li>
                                <li><strong>Backup</strong> (Velero) - Disaster recovery</li>
                                <li><strong>Database</strong> (Operators) - Stateful apps</li>
                                <li><strong>Security Policies</strong> - Advanced security</li>
                            </ul>
                            <p><strong>Managed by:</strong> Custom controllers</p>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4><span class="emoji">üí°</span> Why Extend Kubernetes?</h4>
                        <p>Native Kubernetes resources provide basic functionality, but real-world applications need:</p>
                        <ul>
                            <li><strong>Advanced Security:</strong> CubeHunter, Kyverno, CubeBench</li>
                            <li><strong>GitOps Capabilities:</strong> Argo CD, Flux</li>
                            <li><strong>Service Mesh:</strong> Istio, Linkerd</li>
                            <li><strong>CI/CD Integration:</strong> Spinnaker, Tekton</li>
                            <li><strong>Monitoring & Observability:</strong> Prometheus, Jaeger</li>
                        </ul>
                    </div>

                    <div class="cncf-landscape">
                        <h3><span class="emoji">üåê</span> CNCF Landscape Reality</h3>
                        <p>Hundreds of applications in the <strong>Cloud Native Computing Foundation</strong> landscape are custom Kubernetes controllers!</p>
                        <div class="examples-grid">
                            <div class="example-card">
                                <h4><span class="emoji">üîí</span> Security</h4>
                                <p>Falco, OPA Gatekeeper, Kyverno</p>
                            </div>
                            <div class="example-card">
                                <h4><span class="emoji">üìä</span> Monitoring</h4>
                                <p>Prometheus, Grafana, Jaeger</p>
                            </div>
                            <div class="example-card">
                                <h4><span class="emoji">üöÄ</span> CI/CD</h4>
                                <p>Argo CD, Tekton, Flux</p>
                            </div>
                            <div class="example-card">
                                <h4><span class="emoji">üåê</span> Networking</h4>
                                <p>Istio, Linkerd, Cilium</p>
                            </div>
                            <div class="example-card">
                                <h4><span class="emoji">üíæ</span> Storage</h4>
                                <p>Rook, Longhorn, OpenEBS</p>
                            </div>
                            <div class="example-card">
                                <h4><span class="emoji">üóÑÔ∏è</span> Databases</h4>
                                <p>PostgreSQL Operator, MongoDB Operator</p>
                            </div>
                        </div>
                    </div>

                    <div class="warning-box">
                        <h4><span class="emoji">‚ö†Ô∏è</span> Kubernetes Core Limitation</h4>
                        <p>Kubernetes <strong>cannot accommodate logic for thousands of custom applications</strong> directly in its core control plane. Instead, it provides an <strong>extensibility mechanism</strong> allowing users to extend the API.</p>
                    </div>
                </div>
            </div>

            <!-- Three Core Components -->
            <div class="section">
                <div class="section-header">
                    <span class="emoji">üîß</span> Three Core Components of Custom Resources
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4><span class="emoji">üéØ</span> To Extend Kubernetes API, You Need Three Things:</h4>
                        <ol>
                            <li><strong>CRD</strong> - Custom Resource Definition</li>
                            <li><strong>CR</strong> - Custom Resource</li>
                            <li><strong>Custom Controller</strong></li>
                        </ol>
                    </div>

                    <div class="three-components">
                        <div class="component-card crd">
                            <h4><span class="emoji">üìã</span> 1. Custom Resource Definition (CRD)</h4>
                            <p><strong>What it is:</strong> A YAML file that defines a new API resource type</p>
                            <p><strong>Purpose:</strong> Schema/template for validation</p>
                            <p><strong>Analogy:</strong> Like a class definition in programming</p>
                            <p><strong>Example:</strong> VirtualService CRD defines what fields a VirtualService can have</p>
                            <div class="code-block">
<pre># Example CRD structure
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: virtualservices.networking.istio.io
spec:
  group: networking.istio.io
  versions:
  - name: v1alpha3
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              hosts:
                type: array
              http:
                type: array</pre>
                            </div>
                        </div>

                        <div class="component-card cr">
                            <h4><span class="emoji">üìÑ</span> 2. Custom Resource (CR)</h4>
                            <p><strong>What it is:</strong> An instance of a Custom Resource Definition</p>
                            <p><strong>Purpose:</strong> Actual configuration object</p>
                            <p><strong>Analogy:</strong> Like an object instance of a class</p>
                            <p><strong>Example:</strong> A specific VirtualService configuration</p>
                            <div class="yaml-block">
<pre># Example CR instance
apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: my-virtual-service
spec:
  hosts:
  - my-service
  http:
  - match:
    - uri:
        prefix: /api
    route:
    - destination:
        host: api-service</pre>
                            </div>
                        </div>

                        <div class="component-card controller">
                            <h4><span class="emoji">ü§ñ</span> 3. Custom Controller</h4>
                            <p><strong>What it is:</strong> Application that watches Custom Resources</p>
                            <p><strong>Purpose:</strong> Implements the actual functionality</p>
                            <p><strong>Analogy:</strong> Like the engine that makes things work</p>
                            <p><strong>Example:</strong> Istio controller configures service mesh based on VirtualService</p>
                            <div class="code-block">
<pre># Controller watches for changes
Controller detects:
- New VirtualService created
- VirtualService updated  
- VirtualService deleted

Then performs actions:
- Configure Envoy proxies
- Update routing rules
- Apply traffic policies</pre>
                            </div>
                        </div>
                    </div>

                    <h3><span class="emoji">‚öñÔ∏è</span> Native vs Custom Resource Comparison</h3>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Aspect</th>
                                <th>Native Resources</th>
                                <th>Custom Resources</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Definition</strong></td>
                                <td>Built into Kubernetes</td>
                                <td>Defined by CRD</td>
                            </tr>
                            <tr>
                                <td><strong>Validation</strong></td>
                                <td>Built-in schema</td>
                                <td>CRD schema</td>
                            </tr>
                            <tr>
                                <td><strong>Controller</strong></td>
                                <td>Built-in (Deployment Controller, etc.)</td>
                                <td>Custom controller needed</td>
                            </tr>
                            <tr>
                                <td><strong>Installation</strong></td>
                                <td>Available out-of-the-box</td>
                                <td>Must install CRD + Controller</td>
                            </tr>
                            <tr>
                                <td><strong>Examples</strong></td>
                                <td>Pod, Service, Deployment</td>
                                <td>VirtualService, Application, Certificate</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Actors and Roles -->
            <div class="section">
                <div class="section-header">
                    <span class="emoji">üë•</span> Actors and Responsibilities
                </div>
                <div class="section-content">
                    <div class="actors-section">
                        <div class="actor-card devops-actor">
                            <h3><span class="emoji">üîß</span> DevOps Engineer</h3>
                            <h4>Primary Responsibilities:</h4>
                            <ul>
                                <li>Deploy Custom Resource Definitions (CRDs)</li>
                                <li>Deploy Custom Controllers</li>
                                <li>Configure and maintain the extended capabilities</li>
                                <li>Debug issues with custom resources</li>
                                <li>Understand the underlying application concepts</li>
                            </ul>
                            <p><strong>Focus:</strong> Infrastructure & Platform Management</p>
                        </div>
                        <div class="actor-card user-actor">
                            <h3><span class="emoji">üë§</span> Users (Developers/Teams)</h3>
                            <h4>Primary Responsibilities:</h4>
                            <ul>
                                <li>Create Custom Resource instances (CRs)</li>
                                <li>Configure application-specific settings</li>
                                <li>Follow documentation for CR structure</li>
                                <li>Test and validate their configurations</li>
                                <li>Report issues to DevOps team</li>
                            </ul>
                            <p><strong>Focus:</strong> Application Configuration & Usage</p>
                        </div>
                    </div>

                    <div class="success-box">
                        <h4><span class="emoji">ü§ù</span> Collaboration Model</h4>
                        <p>DevOps Engineers provide the <strong>platform capabilities</strong> (CRD + Controller), and Users consume those capabilities by creating <strong>Custom Resource instances</strong> for their specific needs.</p>
                    </div>
                </div>
            </div>

            <!-- Complete Flow -->
            <div class="section">
                <div class="section-header">
                    <span class="emoji">üîÑ</span> Complete Custom Resource Flow
                </div>
                <div class="section-content">
                    <div class="complete-flow">
                        <h3><span class="emoji">üìä</span> End-to-End Process</h3>
                        <div class="flow-diagram">
                            <div class="flow-step">Deploy CRD</div>
                            <div class="flow-step">Deploy Controller</div>
                            <div class="flow-step">User Creates CR</div>
                            <div class="flow-step">API Validation</div>
                            <div class="flow-step">Controller Action</div>
                        </div>
                    </div>

                    <div class="step-sequence">
                        <div class="step">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <h4><span class="emoji">üìã</span> DevOps: Deploy Custom Resource Definition</h4>
                                <p>Install the CRD that extends Kubernetes API with new resource type</p>
                                <div class="code-block">
<pre># Example: Install Istio VirtualService CRD
kubectl apply -f istio-crd.yaml

# This extends Kubernetes API to understand VirtualService</pre>
                                </div>
                            </div>
                        </div>

                        <div class="step">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <h4><span class="emoji">ü§ñ</span> DevOps: Deploy Custom Controller</h4>
                                <p>Install the application that will watch and act on the custom resources</p>
                                <div class="code-block">
<pre># Example: Install Istio controller
helm install istiod istio/istiod -n istio-system

# This controller watches for VirtualService changes</pre>
                                </div>
                            </div>
                        </div>

                        <div class="step">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <h4><span class="emoji">üë§</span> User: Create Custom Resource Instance</h4>
                                <p>User creates a YAML file defining their specific configuration</p>
                                <div class="yaml-block">
<pre># user-virtualservice.yaml
apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: my-app-routing
spec:
  hosts:
  - my-app
  http:
  - route:
    - destination:
        host: my-app-v1
        weight: 90
    - destination:
        host: my-app-v2
        weight: 10</pre>
                                </div>
                            </div>
                        </div>

                        <div class="step">
                            <div class="step-number">4</div>
                            <div class="step-content">
                                <h4><span class="emoji">‚úÖ</span> Kubernetes: Validate Against CRD</h4>
                                <p>API server validates the CR against the installed CRD schema</p>
                                <div class="validation-flow">
                                    <h5>Validation Process:</h5>
                                    <ul>
                                        <li><strong>Check structure:</strong> Does YAML match CRD schema?</li>
                                        <li><strong>Validate fields:</strong> Are all required fields present?</li>
                                        <li><strong>Type checking:</strong> Are field types correct?</li>
                                        <li><strong>Success:</strong> Create CR object in etcd</li>
                                        <li><strong>Failure:</strong> Return validation error to user</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="step">
                            <div class="step-number">5</div>
                            <div class="step-content">
                                <h4><span class="emoji">‚ö°</span> Controller: Implement Functionality</h4>
                                <p>Custom controller detects the new CR and performs required actions</p>
                                <div class="code-block">
<pre># Istio controller actions:
1. Watch for VirtualService changes
2. Read the routing configuration
3. Generate Envoy proxy configuration
4. Update service mesh routing rules
5. Apply traffic splitting (90% v1, 10% v2)

# Result: Traffic routing implemented as specified</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4><span class="emoji">üîÑ</span> Continuous Process</h4>
                        <p>This is a <strong>continuous process</strong>. The controller keeps watching for changes to Custom Resources and automatically adjusts the system configuration accordingly.</p>
                    </div>
                </div>
            </div>

            <!-- Detailed Component Deep Dive -->
            <div class="section">
                <div class="section-header">
                    <span class="emoji">üîç</span> Deep Dive: Understanding Each Component
                </div>
                <div class="section-content">
                    <h3><span class="emoji">üìã</span> 1. Custom Resource Definition (CRD) Deep Dive</h3>
                    <div class="comparison-table">
                        <thead>
                            <tr>
                                <th>Native Resource Example</th>
                                <th>Custom Resource Example</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <strong>Deployment</strong> has built-in definition<br>
                                    Fields: apiVersion, kind, metadata, spec.template, spec.replicas, etc.
                                </td>
                                <td>
                                    <strong>VirtualService</strong> definition comes from CRD<br>
                                    Fields: apiVersion, kind, metadata, spec.hosts, spec.http, etc.
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="yaml-block">
<pre># Example: How Kubernetes knows Deployment structure
# Built into Kubernetes core - no CRD needed
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx
spec:
  replicas: 3          # Kubernetes knows this field
  template:            # Kubernetes knows this field
    spec:
      containers:      # Kubernetes knows this field
      - name: nginx
        image: nginx</pre>
                    </div>

                    <div class="yaml-block">
<pre># Example: VirtualService CRD defines structure
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: virtualservices.networking.istio.io
spec:
  group: networking.istio.io
  scope: Namespaced
  names:
    plural: virtualservices
    singular: virtualservice
    kind: VirtualService
  versions:
  - name: v1alpha3
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              hosts:                    # CRD defines this field
                type: array
                items:
                  type: string
              http:                     # CRD defines this field
                type: array
              tcp:                      # CRD defines this field
                type: array</pre>
                    </div>

                    <h3><span class="emoji">üìÑ</span> 2. Custom Resource (CR) Deep Dive</h3>
                    <div class="info-box">
                        <h4><span class="emoji">üí°</span> CR Validation Process</h4>
                        <p>When a user submits a Custom Resource YAML:</p>
                        <ol>
                            <li>Kubernetes API server receives the CR</li>
                            <li>Looks up the corresponding CRD</li>
                            <li>Validates CR structure against CRD schema</li>
                            <li>If valid: Creates CR object in etcd</li>
                            <li>If invalid: Returns error to user</li>
                        </ol>
                    </div>

                    <div class="yaml-block">
<pre># Valid Custom Resource (matches CRD schema)
apiVersion: networking.istio.io/v1alpha3
kind: VirtualService                    # Matches CRD kind
metadata:
  name: reviews-route
spec:
  hosts:                               # Field defined in CRD ‚úÖ
  - reviews
  http:                                # Field defined in CRD ‚úÖ
  - match:
    - headers:
        end-user:
          exact: jason
    route:
    - destination:
        host: reviews
        subset: v2</pre>
                    </div>

                    <div class="code-block">
<pre># Invalid Custom Resource (would be rejected)
apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: invalid-example
spec:
  hosts:
  - reviews
  invalidField: "not-allowed"          # ‚ùå Not defined in CRD
  http:
  - route:
    - destination: "wrong-type"        # ‚ùå Wrong data type

# Error: ValidationError: unknown field "invalidField"</pre>
                    </div>

                    <h3><span class="emoji">ü§ñ</span> 3. Custom Controller Deep Dive</h3>
                    <div class="warning-box">
                        <h4><span class="emoji">‚ö†Ô∏è</span> Without Controller = No Action</h4>
                        <p>Creating a Custom Resource without a controller is like writing a recipe but having no chef to cook it. The CR will exist in the cluster, but <strong>nothing will happen</strong>.</p>
                    </div>

                    <div class="code-block">
<pre># What a Custom Controller Does:

1. WATCH for Custom Resource changes
   - New CR created
   - Existing CR updated  
   - CR deleted

2. PROCESS the changes
   - Read CR configuration
   - Validate business logic
   - Determine required actions

3. IMPLEMENT the functionality
   - Configure external systems
   - Update cluster state
   - Manage related resources

# Example: Istio Controller Actions
VirtualService Created ‚Üí Configure Envoy Proxies ‚Üí Update Routing Rules
VirtualService Updated ‚Üí Reconfigure Proxies ‚Üí Apply New Routes  
VirtualService Deleted ‚Üí Clean up Proxy Config ‚Üí Remove Routes</pre>
                    </div>
                </div>
            </div>

            <!-- Development Insights -->
            <div class="section">
                <div class="section-header">
                    <span class="emoji">üíª</span> How Custom Controllers Are Built
                </div>
                <div class="section-content">
                    <div class="development-info">
                        <h3><span class="emoji">üõ†Ô∏è</span> Technology Stack for Custom Controllers</h3>
                        <div class="tech-stack">
                            <div class="tech-item">
                                <h4><span class="emoji">üîµ</span> Go (Golang)</h4>
                                <p>Most popular choice</p>
                                <p>Kubernetes is built in Go</p>
                            </div>
                            <div class="tech-item">
                                <h4><span class="emoji">üêç</span> Python</h4>
                                <p>Growing popularity</p>
                                <p>Good for prototyping</p>
                            </div>
                            <div class="tech-item">
                                <h4><span class="emoji">‚òï</span> Java</h4>
                                <p>Enterprise environments</p>
                                <p>Good for complex logic</p>
                            </div>
                            <div class="tech-item">
                                <h4><span class="emoji">üìö</span> client-go</h4>
                                <p>Primary Go library</p>
                                <p>Kubernetes API interaction</p>
                            </div>
                        </div>
                    </div>

                    <h3><span class="emoji">üîÑ</span> Controller Architecture Pattern</h3>
                    <div class="code-block">
<pre># Core Controller Components:

1. WATCHER
   - Monitors Kubernetes API for resource changes
   - Uses Kubernetes List/Watch API
   - Efficiently tracks only relevant resources

2. REFLECTOR  
   - Part of client-go library
   - Maintains local cache of resources
   - Reduces API server load

3. WORK QUEUE
   - FIFO queue for processing events
   - Handles event ordering and retries
   - Prevents overwhelming the controller

4. CONTROLLER LOGIC
   - Business logic implementation
   - Reconciliation loop
   - Desired state vs actual state comparison

5. CLIENT INTERFACE
   - Kubernetes API client
   - Creates/updates/deletes resources
   - Handles authentication and networking</pre>
                    </div>

                    <div class="info-box">
                        <h4><span class="emoji">üöÄ</span> Modern Development Tools</h4>
                        <ul>
                            <li><strong>controller-runtime:</strong> Go framework by Kubernetes team</li>
                            <li><strong>Operator SDK:</strong> High-level tool for building operators</li>
                            <li><strong>Kubebuilder:</strong> SDK for building Kubernetes APIs</li>
                            <li><strong>KUDO:</strong> Kubernetes Universal Declarative Operator</li>
                        </ul>
                    </div>

                    <div class="warning-box">
                        <h4><span class="emoji">üí°</span> DevOps Engineer Focus</h4>
                        <p>Most DevOps Engineers don't need to <strong>write</strong> custom controllers. Your focus should be on:</p>
                        <ul>
                            <li>Understanding the concepts</li>
                            <li>Deploying existing controllers</li>
                            <li>Debugging issues</li>
                            <li>Configuration and maintenance</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Practical Example: Istio -->
            <div class="section">
                <div class="section-header">
                    <span class="emoji">üåê</span> Practical Example: Deploying Istio with Helm
                </div>
                <div class="section-content">
                    <div class="istio-example">
                        <h3><span class="emoji">üöÄ</span> Real-World Deployment: Istio Service Mesh</h3>
                        <p>Let's walk through deploying a complete custom resource system using Istio as an example.</p>
                    </div>

                    <div class="step-sequence">
                        <div class="step">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <h4>Add Istio Helm Repository</h4>
                                <div class="code-block">
<pre># Add the official Istio Helm repository
helm repo add istio https://istio-release.storage.googleapis.com/charts

# Update your local Helm repo cache
helm repo update</pre>
                                </div>
                            </div>
                        </div>

                        <div class="step">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <h4>Create Istio Namespace</h4>
                                <div class="code-block">
<pre># Create dedicated namespace for Istio components
kubectl create namespace istio-system</pre>
                                </div>
                            </div>
                        </div>

                        <div class="step">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <h4>Install Istio Base (CRDs)</h4>
                                <div class="code-block">
<pre># Install Istio base chart containing CRDs
helm install istio-base istio/base -n istio-system

# This installs Custom Resource Definitions like:
# - VirtualService
# - DestinationRule  
# - Gateway
# - ServiceEntry
# - And many more...</pre>
                                </div>
                            </div>
                        </div>

                        <div class="step">
                            <div class="step-number">4</div>
                            <div class="step-content">
                                <h4>Install Istio Control Plane (Controller)</h4>
                                <div class="code-block">
<pre># Install Istio control plane with custom controller
helm install istiod istio/istiod -n istio-system --wait

# This deploys:
# - Istio controller (istiod)
# - Admission webhooks
# - Certificate management
# - Service discovery</pre>
                                </div>
                            </div>
                        </div>

                        <div class="step">
                            <div class="step-number">5</div>
                            <div class="step-content">
                                <h4>Verify Installation</h4>
                                <div class="code-block">
<pre># Check CRDs are installed
kubectl get crd | grep istio

# Expected output shows Istio CRDs:
# gateways.networking.istio.io
# virtualservices.networking.istio.io  
# destinationrules.networking.istio.io
# serviceentries.networking.istio.io

# Check controller is running
kubectl get pods -n istio-system

# Expected output:
# NAME                      READY   STATUS    RESTARTS   AGE
# istiod-7d6bfc88c9-xyz     1/1     Running   0          2m</pre>
                                </div>
                            </div>
                        </div>

                        <div class="step">
                            <div class="step-number">6</div>
                            <div class="step-content">
                                <h4>User Creates Custom Resource</h4>
                                <div class="yaml-block">
<pre># Now users can create VirtualService resources
apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: bookinfo
spec:
  hosts:
  - bookinfo
  http:
  - match:
    - uri:
        prefix: /productpage
    - uri:
        prefix: /static
    route:
    - destination:
        host: productpage</pre>
                                </div>
                                <div class="code-block">
<pre># Apply the custom resource
kubectl apply -f virtualservice.yaml

# Istio controller automatically:
# 1. Detects new VirtualService
# 2. Configures Envoy proxies
# 3. Implements routing rules</pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="success-box">
                        <h4><span class="emoji">üéâ</span> Result</h4>
                        <p>You now have a fully functional service mesh with custom routing capabilities! Users can create VirtualService resources to configure traffic management without touching infrastructure.</p>
                    </div>
                </div>
            </div>

            <!-- DevOps Responsibilities -->
            <div class="section">
                <div class="section-header">
                    <span class="emoji">üë®‚Äçüíº</span> DevOps Engineer Responsibilities
                </div>
                <div class="section-content">
                    <div class="warning-box">
                        <h4><span class="emoji">‚ö†Ô∏è</span> Beyond Just Deployment</h4>
                        <p>Installing CRDs and controllers is just the beginning. DevOps Engineers have ongoing responsibilities for maintaining these systems.</p>
                    </div>

                    <div class="responsibilities-grid">
                        <div class="responsibility-card">
                            <h4><span class="emoji">‚öôÔ∏è</span> Installation & Configuration</h4>
                            <ul>
                                <li>Deploy CRDs correctly</li>
                                <li>Install custom controllers</li>
                                <li>Configure RBAC permissions</li>
                                <li>Set up monitoring and alerting</li>
                            </ul>
                        </div>
                        <div class="responsibility-card">
                            <h4><span class="emoji">üîç</span> Debugging & Troubleshooting</h4>
                            <ul>
                                <li>Analyze controller logs</li>
                                <li>Debug CR validation issues</li>
                                <li>Investigate resource creation failures</li>
                                <li>Resolve configuration conflicts</li>
                            </ul>
                        </div>
                        <div class="responsibility-card">
                            <h4><span class="emoji">üìö</span> Understanding Applications</h4>
                            <ul>
                                <li>Master the application concepts</li>
                                <li>Understand configuration options</li>
                                <li>Know integration patterns</li>
                                <li>Follow best practices</li>
                            </ul>
                        </div>
                        <div class="responsibility-card">
                            <h4><span class="emoji">üîÑ</span> Maintenance & Updates</h4>
                            <ul>
                                <li>Upgrade controllers safely</li>
                                <li>Migrate CRD versions</li>
                                <li>Backup custom resources</li>
                                <li>Monitor resource usage</li>
                            </ul>
                        </div>
                    </div>

                    <h3><span class="emoji">üõ†Ô∏è</span> Essential Debugging Commands</h3>
                    <div class="code-block">
<pre># Debug Custom Resources
kubectl describe virtualservice my-service
kubectl get virtualservice my-service -o yaml

# Check controller logs  
kubectl logs -n istio-system deployment/istiod

# Verify CRDs are installed
kubectl get crd | grep istio

# Check API resources available
kubectl api-resources | grep networking.istio.io

# Debug validation issues
kubectl apply -f resource.yaml --dry-run=server --validate=true

# Check controller status
kubectl get pods -n istio-system
kubectl describe pod istiod-xxx -n istio-system</pre>
                    </div>

                    <h3><span class="emoji">üìñ</span> Common Issues & Solutions</h3>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Issue</th>
                                <th>Symptoms</th>
                                <th>Solution</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>CRD not installed</td>
                                <td>"no matches for kind VirtualService"</td>
                                <td>Install CRDs first</td>
                            </tr>
                            <tr>
                                <td>Controller not running</td>
                                <td>CR created but no action</td>
                                <td>Check controller pod status</td>
                            </tr>
                            <tr>
                                <td>Validation failure</td>
                                <td>"unknown field" or "invalid value"</td>
                                <td>Check CR against CRD schema</td>
                            </tr>
                            <tr>
                                <td>RBAC issues</td>
                                <td>Permission denied errors</td>
                                <td>Verify service account permissions</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info-box">
                        <h4><span class="emoji">üí°</span> Success Strategy</h4>
                        <p>There's no rocket science here. Success comes from:</p>
                        <ul>
                            <li><strong>Following documentation carefully</strong> for installation</li>
                            <li><strong>Understanding the application concepts</strong> deeply</li>
                            <li><strong>Practicing debugging techniques</strong> systematically</li>
                            <li><strong>Building expertise gradually</strong> with real projects</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Summary -->
            <div class="section">
                <div class="section-header">
                    <span class="emoji">üéØ</span> Summary & Key Takeaways
                </div>
                <div class="section-content">
                    <div class="success-box">
                        <h4><span class="emoji">üèÜ</span> What You've Learned</h4>
                        <ul>
                            <li>‚úÖ <strong>Custom Resource Definitions (CRDs):</strong> Schemas that define new API resource types</li>
                            <li>‚úÖ <strong>Custom Resources (CRs):</strong> Instances of CRDs created by users</li>
                            <li>‚úÖ <strong>Custom Controllers:</strong> Applications that watch and act on Custom Resources</li>
                            <li>‚úÖ <strong>Complete Flow:</strong> From CRD installation to functional custom capabilities</li>
                            <li>‚úÖ <strong>Real Example:</strong> Istio deployment with Helm</li>
                            <li>‚úÖ <strong>DevOps Responsibilities:</strong> Installation, debugging, and maintenance</li>
                        </ul>
                    </div>

                    <h3><span class="emoji">üîë</span> Key Concepts Mastered</h3>
                    <div class="three-components">
                        <div class="component-card">
                            <h4><span class="emoji">üéØ</span> API Extension</h4>
                            <p>Kubernetes provides extensibility mechanisms to add new capabilities without modifying core</p>
                        </div>
                        <div class="component-card">
                            <h4><span class="emoji">üîÑ</span> Watch Pattern</h4>
                            <p>Controllers continuously watch for resource changes and reconcile desired vs actual state</p>
                        </div>
                        <div class="component-card">
                            <h4><span class="emoji">üìã</span> Schema Validation</h4>
                            <p>CRDs provide validation schemas ensuring Custom Resources have correct structure</p>
                        </div>
                    </div>

                    <h3><span class="emoji">üåê</span> CNCF Ecosystem Understanding</h3>
                    <div class="cncf-landscape">
                        <h4>You now understand how hundreds of CNCF projects work!</h4>
                        <p>Most cloud-native tools follow this same pattern:</p>
                        <div class="examples-grid">
                            <div class="example-card">
                                <h4>Argo CD</h4>
                                <p>Application CRD + GitOps Controller</p>
                            </div>
                            <div class="example-card">
                                <h4>Prometheus</h4>
                                <p>ServiceMonitor CRD + Operator</p>
                            </div>
                            <div class="example-card">
                                <h4>cert-manager</h4>
                                <p>Certificate CRD + Controller</p>
                            </div>
                            <div class="example-card">
                                <h4>Crossplane</h4>
                                <p>CompositeResource CRD + Provider Controllers</p>
                            </div>
                        </div>
                    </div>

                    <h3><span class="emoji">üìã</span> Essential Commands Reference</h3>
                    <div class="code-block">
<pre># CRD Management
kubectl get crd                       # List all CRDs
kubectl describe crd virtualservices  # CRD details

# Custom Resource Management  
kubectl get virtualservice            # List Custom Resources
kubectl describe virtualservice name  # CR details
kubectl get vs name -o yaml          # Full CR configuration

# Controller Debugging
kubectl logs -n istio-system deployment/istiod  # Controller logs
kubectl get pods -n istio-system               # Controller status

# Installation with Helm
helm repo add istio https://istio-release.storage.googleapis.com/charts
helm install istio-base istio/base -n istio-system
helm install istiod istio/istiod -n istio-system --wait</pre>
                    </div>

                    <div class="highlight-box">
                        <strong><span class="emoji">üöÄ</span> Next Steps:</strong><br>
                        Explore the CNCF landscape and practice deploying custom controllers like Argo CD, Prometheus Operator, or cert-manager using the same principles you've learned today!
                    </div>

                    <div class="info-box">
                        <h4><span class="emoji">üí°</span> Career Impact</h4>
                        <p>Understanding Custom Resources positions you to work with any modern Kubernetes-native application. This knowledge is essential for platform engineering, DevOps, and cloud-native development roles.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>